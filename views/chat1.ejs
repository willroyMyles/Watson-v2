<!DOCTYPE html>
<html class=''>
<head>

<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css'>
	 <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css'>

	<link rel="stylesheet" media="screen" href="/assets/bootstrp.min.css")>
	<link rel="stylesheet" media="screen" href="/assets/main.css")>

</head>
<body>
<div id="frame">
	<div class="content">
		<div class="contact-profile">
			<img src="/images/watson.png") alt="" />
			<p>Utech Watson Assistant</p>
			<div class="social-media">
				<i class="fa fa-facebook" aria-hidden="false"></i>
				<i class="fa fa-twitter" aria-hidden="true"></i>
				 <i class="fa fa-instagram" aria-hidden="true"></i>
			</div>
		</div>
		<div class="messages">
			<ul>
				<%# <li class="sent">
					<img src="http://emilcarlsson.se/assets/mikeross.png" alt="" />
					<p>How the hell am I supposed to get a jury to believe you when I am not even sure that I do?!</p>
				</li>
				<li class="replies">
					<img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
					<p>When you're backed against the wall, break the god damn thing down.</p>
				</li>
				<li class="replies">
					<img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
					<p>Excuses don't win championships.</p>
				</li>
				<li class="sent">
					<img src="http://emilcarlsson.se/assets/mikeross.png" alt="" />
					<p>Oh yeah, did Michael Jordan tell you that?</p>
				</li>
				<li class="replies">
					<img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
					<p>No, I told him that.</p>
				</li>
				<li class="replies">
					<img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
					<p>What are your choices when someone puts a gun to your head?</p>
				</li>
				<li class="sent">
					<img src="http://emilcarlsson.se/assets/mikeross.png" alt="" />
					<p>What are you talking about? You do what they say or they shoot you.</p>
				</li>
				<li class="replies">
					<img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
					<p>Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things.</p>
				</li> %>
			</ul>
		</div>
        <div class="message-input">
			<div class="wrap">				
			<input type="text" placeholder="Write your message..." />
			<button class="submit" type="submit" onclick=""><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
			</div>
		</div>

	</div>
</div>
<script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
<script >$(".messages").animate({ scrollTop: $(document).height() }, "fast");


function newMessage() {
	message = $(".message-input input").val();
	if($.trim(message) == '') {
		return false;
	}
	$('<li class="sent"><img src="@routes.Assets.versioned("images/male.png")" alt="" /><p>' + message + '</p></li>').appendTo($('.messages ul'));
	$('.message-input input').val(null);
	//$('.contact.active .preview').html('<span>You: </span>' + message);
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
};

function writeMessage(msg){
	$('<li class="replies"><img src=/images/watson.png")" alt="" /><p>' + msg + '</p></li>').appendTo($('.messages ul'));
//	$('.contact.active .preview').html('<span>You: </span>' + msg);
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
}

function writeOption(element){
//	$('.message-input input').val(null);
//	$('.contact.active .preview').html('<span>You: </span>' + msg);

element.option.forEach(option =>{
		var buttonLabel = option.label;
		var buttonValue = option.value.input.text;
$('<li class="replies"><img src=/images/watson.png")" alt="" /><p>' + element.title + '<br><button class="option-button" onclick="" href="#">'+  buttonLabel +'</button> </p></li>').appendTo($('.messages ul'));
		$(".option-button").click(function(){
				sendMsgToController(buttonValue);
		});
});
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
}

function sendMsgToController(msg){
	console.log(msg);
	item = {item: msg};
      $.ajax({
        type: 'POST',
        url: '/chat',
        data: item,
        success: function(data){
					//do something with the data via front-end framework
					data.forEach(element => {
						if(element.response_type === 'text') writeMessage(element.text);
						if(element.response_type === 'option') writeOption(element);
					});
        }
      });
}

function sendToController(){
	message = $(".message-input input").val();
	if($.trim(message) == '') {
		return false;
	}
	
	item = {item: message};
      $.ajax({
        type: 'POST',
        url: '/chat',
        data: item,
        success: function(data){
					//do something with the data via front-end framework
					data.forEach(element => {
						if(element.response_type === 'text') writeMessage(element.text);
						if(element.response_type === 'option') writeOption(element);
					});
        }
      });
}

$('.submit').click(function() {
		sendToController();
	newMessage();
	//  send to controller
});

$(window).on('keydown', function(e) {
  if (e.which == 13) {
		sendToController();
		newMessage();
    return false;
  }
});

$(document).ready(function(){

	setTimeout(() => {
			sendMsgToController('hi');
	}, 2000);

});
//# sourceURL=pen.js
</script>
</body></html>